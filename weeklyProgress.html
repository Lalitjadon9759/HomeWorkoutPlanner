<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Progress and Performance Tracker</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #2c3e50, #4ca1af);
      color: white;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .tracker, .milestone {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      margin: 20px auto;
      border-radius: 12px;
      max-width: 700px;
    }
    input, button {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
    }
    canvas {
      margin: 20px auto;
      display: block;
      max-width: 700px;
      background: white;
      border-radius: 12px;
    }
    .download-buttons {
      text-align: center;
      margin-top: 20px;
    }
    .download-buttons button {
      margin: 5px;
      width: 30%;
    }
  </style>
</head>
<body>

<h1>Daniel's Workout Progress Tracker</h1>

<div class="tracker">
  <h2>Add Daily Workout</h2>
  <input type="date" id="date" />
  <input type="number" id="workouts" placeholder="Completed Workouts" />
  <input type="number" id="calories" placeholder="Calories Burned" />
  <input type="number" id="muscle" placeholder="Muscle Gain (kg)" />
  <button onclick="addProgress()">Add Progress</button>
</div>

<div class="milestone">
  <h2>Set Milestone</h2>
  <input type="text" id="milestoneText" placeholder="E.g. Lose 2kg in 30 days" />
  <button onclick="setMilestone()">Set Milestone</button>
  <p id="milestoneDisplay"></p>
</div>

<canvas id="progressChart" width="400" height="200"></canvas>

<div class="download-buttons">
  <button onclick="downloadProgress('daily')">Download Daily</button>
  <button onclick="downloadProgress('weekly')">Download Weekly</button>
  <button onclick="downloadProgress('monthly')">Download Monthly</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  let progressData = [];

  function addProgress() {
    const date = document.getElementById('date').value;
    const workouts = parseInt(document.getElementById('workouts').value);
    const calories = parseInt(document.getElementById('calories').value);
    const muscle = parseFloat(document.getElementById('muscle').value);

    if (!date || isNaN(workouts) || isNaN(calories) || isNaN(muscle)) {
      alert("Please fill all fields correctly!");
      return;
    }

    const entry = { date, workouts, calories, muscle };
    progressData.push(entry);
    updateChart();
    clearInputs();
  }

  function setMilestone() {
    const text = document.getElementById('milestoneText').value;
    document.getElementById('milestoneDisplay').textContent = `Milestone: ${text}`;
    document.getElementById('milestoneText').value = '';
  }

  function updateChart() {
    const labels = progressData.map(item => item.date);
    const workouts = progressData.map(item => item.workouts);
    const calories = progressData.map(item => item.calories);
    const muscle = progressData.map(item => item.muscle);

    if (window.myChart) window.myChart.destroy();

    const ctx = document.getElementById('progressChart').getContext('2d');
    window.myChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [
          {
            label: 'Workouts',
            data: workouts,
            borderColor: '#f39c12',
            fill: false
          },
          {
            label: 'Calories',
            data: calories,
            borderColor: '#e74c3c',
            fill: false
          },
          {
            label: 'Muscle (kg)',
            data: muscle,
            borderColor: '#2ecc71',
            fill: false
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { labels: { color: 'black' } },
        },
        scales: {
          x: { ticks: { color: 'black' } },
          y: { ticks: { color: 'black' } }
        }
      }
    });
  }

  function clearInputs() {
    document.getElementById('date').value = '';
    document.getElementById('workouts').value = '';
    document.getElementById('calories').value = '';
    document.getElementById('muscle').value = '';
  }

  function downloadProgress(type) {
    const now = new Date();
    let filteredData = [];

    if (type === 'daily') {
      filteredData = progressData.filter(entry =>
        new Date(entry.date).toDateString() === now.toDateString());
    } else if (type === 'weekly') {
      const weekAgo = new Date(now);
      weekAgo.setDate(now.getDate() - 7);
      filteredData = progressData.filter(entry =>
        new Date(entry.date) >= weekAgo && new Date(entry.date) <= now);
    } else if (type === 'monthly') {
      const monthAgo = new Date(now);
      monthAgo.setMonth(now.getMonth() - 1);
      filteredData = progressData.filter(entry =>
        new Date(entry.date) >= monthAgo && new Date(entry.date) <= now);
    }

    if (filteredData.length === 0) {
      alert("No data available for the selected period.");
      return;
    }

    const textContent = filteredData.map((entry, index) => 
      `Entry ${index + 1}:\n` +
      `Date: ${entry.date}\n` +
      `Workouts Completed: ${entry.workouts}\n` +
      `Calories Burned: ${entry.calories}\n` +
      `Muscle Gained: ${entry.muscle} kg\n`
    ).join('\n-----------------------\n');

    const blob = new Blob([`Daniel's ${type.charAt(0).toUpperCase() + type.slice(1)} Progress Report\n\n` + textContent], { type: 'text/plain' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = `${type}_progress.txt`;
    link.click();
  }
</script>
</body>
</html>
